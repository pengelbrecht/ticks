{
  "version": 3,
  "sources": ["../../.pnpm/@shoelace-style+shoelace@2.20.1_@floating-ui+utils@0.2.10_@types+react@19.2.8/node_modules/@shoelace-style/shoelace/dist/chunks/chunk.EMN3H5QW.js"],
  "sourcesContent": ["import {\n  activeElements,\n  getDeepestActiveElement,\n  getTabbableElements\n} from \"./chunk.VESXC477.js\";\n\n// src/internal/modal.ts\nvar activeModals = [];\nvar Modal = class {\n  constructor(element) {\n    this.tabDirection = \"forward\";\n    this.handleFocusIn = () => {\n      if (!this.isActive()) return;\n      this.checkFocus();\n    };\n    this.handleKeyDown = (event) => {\n      var _a;\n      if (event.key !== \"Tab\" || this.isExternalActivated) return;\n      if (!this.isActive()) return;\n      const currentActiveElement = getDeepestActiveElement();\n      this.previousFocus = currentActiveElement;\n      if (this.previousFocus && this.possiblyHasTabbableChildren(this.previousFocus)) {\n        return;\n      }\n      if (event.shiftKey) {\n        this.tabDirection = \"backward\";\n      } else {\n        this.tabDirection = \"forward\";\n      }\n      const tabbableElements = getTabbableElements(this.element);\n      let currentFocusIndex = tabbableElements.findIndex((el) => el === currentActiveElement);\n      this.previousFocus = this.currentFocus;\n      const addition = this.tabDirection === \"forward\" ? 1 : -1;\n      while (true) {\n        if (currentFocusIndex + addition >= tabbableElements.length) {\n          currentFocusIndex = 0;\n        } else if (currentFocusIndex + addition < 0) {\n          currentFocusIndex = tabbableElements.length - 1;\n        } else {\n          currentFocusIndex += addition;\n        }\n        this.previousFocus = this.currentFocus;\n        const nextFocus = (\n          /** @type {HTMLElement} */\n          tabbableElements[currentFocusIndex]\n        );\n        if (this.tabDirection === \"backward\") {\n          if (this.previousFocus && this.possiblyHasTabbableChildren(this.previousFocus)) {\n            return;\n          }\n        }\n        if (nextFocus && this.possiblyHasTabbableChildren(nextFocus)) {\n          return;\n        }\n        event.preventDefault();\n        this.currentFocus = nextFocus;\n        (_a = this.currentFocus) == null ? void 0 : _a.focus({ preventScroll: false });\n        const allActiveElements = [...activeElements()];\n        if (allActiveElements.includes(this.currentFocus) || !allActiveElements.includes(this.previousFocus)) {\n          break;\n        }\n      }\n      setTimeout(() => this.checkFocus());\n    };\n    this.handleKeyUp = () => {\n      this.tabDirection = \"forward\";\n    };\n    this.element = element;\n    this.elementsWithTabbableControls = [\"iframe\"];\n  }\n  /** Activates focus trapping. */\n  activate() {\n    activeModals.push(this.element);\n    document.addEventListener(\"focusin\", this.handleFocusIn);\n    document.addEventListener(\"keydown\", this.handleKeyDown);\n    document.addEventListener(\"keyup\", this.handleKeyUp);\n  }\n  /** Deactivates focus trapping. */\n  deactivate() {\n    activeModals = activeModals.filter((modal) => modal !== this.element);\n    this.currentFocus = null;\n    document.removeEventListener(\"focusin\", this.handleFocusIn);\n    document.removeEventListener(\"keydown\", this.handleKeyDown);\n    document.removeEventListener(\"keyup\", this.handleKeyUp);\n  }\n  /** Determines if this modal element is currently active or not. */\n  isActive() {\n    return activeModals[activeModals.length - 1] === this.element;\n  }\n  /** Activates external modal behavior and temporarily disables focus trapping. */\n  activateExternal() {\n    this.isExternalActivated = true;\n  }\n  /** Deactivates external modal behavior and re-enables focus trapping. */\n  deactivateExternal() {\n    this.isExternalActivated = false;\n  }\n  checkFocus() {\n    if (this.isActive() && !this.isExternalActivated) {\n      const tabbableElements = getTabbableElements(this.element);\n      if (!this.element.matches(\":focus-within\")) {\n        const start = tabbableElements[0];\n        const end = tabbableElements[tabbableElements.length - 1];\n        const target = this.tabDirection === \"forward\" ? start : end;\n        if (typeof (target == null ? void 0 : target.focus) === \"function\") {\n          this.currentFocus = target;\n          target.focus({ preventScroll: false });\n        }\n      }\n    }\n  }\n  possiblyHasTabbableChildren(element) {\n    return this.elementsWithTabbableControls.includes(element.tagName.toLowerCase()) || element.hasAttribute(\"controls\");\n  }\n};\n\nexport {\n  Modal\n};\n"],
  "mappings": "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",
  "names": []
}
