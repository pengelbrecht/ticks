{
  "id": "771",
  "title": "Backwards Compatibility",
  "description": "Maintain compatibility with existing manual field:\n- Read: If manual=true and awaiting=null, treat as awaiting=work\n- Write: Always write to awaiting, clear manual field\n- CLI: --manual shows deprecation warning, maps to --awaiting work\n- Queries: Check both awaiting and manual fields when filtering\n\nMigration path: v2.0 supports both, v3.0 removes manual.",
  "notes": "2026-01-14 18:42 - Completed task 3vk: Manual to Awaiting read compatibility is fully implemented. Key details: (1) tick.IsAwaitingHuman() returns true for Manual=true OR Awaiting\\!=nil (2) tick.GetAwaitingType() returns 'work' for Manual=true when Awaiting=nil (3) Query layer uses helpers consistently (4) Approve/reject commands normalize Manual=true to Awaiting='work' before ProcessVerdict. All backwards compat tests pass.\n2026-01-14 18:45 - Completed task zr8: Implemented SetAwaiting(value) and ClearAwaiting() methods in tick.go. All production code updated to use them: verdict.go uses ClearAwaiting(), close.go uses SetAwaiting(), main.go uses both for --manual/--awaiting flags and approve/reject commands. All Awaiting writes now clear Manual field for migration. Tests added for both methods.\n2026-01-14 18:47 - Completed task 9gy: All query logic for backwards compatibility was already implemented by task 3vk. Key helper methods: IsAwaitingHuman() (returns true for Manual=true OR Awaiting\\!=nil) and GetAwaitingType() (returns 'work' for Manual=true when Awaiting=nil). These are used by: query.Ready(), query.Apply() filters, tk list --awaiting, tk next --awaiting. Tests confirm Manual=true ticks are treated as awaiting=work in all query contexts.\n2026-01-14 18:52 - Completed task ws7: Added comprehensive backwards compatibility tests in internal/tick/backcompat_test.go and internal/query/backcompat_test.go. Tests verify: (1) IsAwaitingHuman/GetAwaitingType helpers handle Manual=true correctly, (2) Ready() excludes Manual=true, (3) tk list --awaiting work includes Manual=true, (4) SetAwaiting/ClearAwaiting clear Manual, (5) JSON round-trip preserves Manual when not explicitly changed. Note: The create command still sets Manual=true when --manual is used (task jop is still open to fix this).\n2026-01-14 18:57 - Completed task jop: --manual flag now fully deprecated. In create command, Manual=false is always set (never true); --manual maps to awaiting=work. Update command already correctly handled this. Added TestManualFlagDeprecation test. Deprecation warning already existed in both create and update commands.",
  "status": "closed",
  "priority": 2,
  "type": "epic",
  "owner": "peter@engelbrecht.dk",
  "parent": "7sn",
  "created_by": "peter@engelbrecht.dk",
  "created_at": "2026-01-14T16:14:32.998773Z",
  "updated_at": "2026-01-14T17:57:36.697448Z",
  "closed_at": "2026-01-14T17:57:36.697448Z",
  "closed_reason": "all tasks completed"
}