{
  "id": "b97",
  "title": "Write CloudCommsClient integration tests against wrangler dev",
  "description": "Create vitest integration tests that test CloudCommsClient against real Worker/DO.\n\nTest file: internal/tickboard/ui/src/comms/cloud-do.test.ts\n\nTests should cover:\n- Connection lifecycle (connect to real DO, disconnect)\n- Receiving tick events (state_full, tick_updated, tick_created, tick_deleted)\n- Write operations flowing through DO to local agent (createTick, closeTick, addNote)\n- Local agent status (test rig connecting/disconnecting updates status)\n- Run stream events (relayed through DO)\n- Error handling (auth failures, connection drops)\n\nSetup:\n- Start wrangler dev\n- Run auth setup script\n- Start test rig with --upstream pointing to wrangler dev\n- Run tests against wrangler dev URL\n\nMirror the same test scenarios as cloud.test.ts but against real DO.",
  "status": "closed",
  "priority": 2,
  "type": "task",
  "owner": "peter@engelbrecht.dk",
  "blocked_by": [
    "nc9",
    "kha",
    "l34"
  ],
  "parent": "gv8",
  "acceptance_criteria": "All CloudCommsClient operations work through real Worker/DO with test rig as local agent",
  "created_by": "peter@engelbrecht.dk",
  "created_at": "2026-01-25T09:25:43.524876Z",
  "updated_at": "2026-01-25T09:36:33.529231Z",
  "closed_at": "2026-01-25T09:36:33.529231Z",
  "closed_reason": "Created cloud-do.test.ts with 16 integration tests against real Worker/DO. Tests cover: connection lifecycle (connect, disconnect, getConnectionInfo, local_status), event reception (tick:updated, tick:deleted, state_full), write operations via DO (createTick, deleteTick, ReadOnlyError), run stream events, error handling (ConnectionError, invalid token), and bidirectional sync. Tests skip gracefully when wrangler dev is not running."
}